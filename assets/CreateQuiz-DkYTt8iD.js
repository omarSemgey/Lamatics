import{u as e,r as s,j as t}from"./vendor-react-B9slfjkH.js";/* empty css             */import{B as n,l as i}from"./vendor-CQ7Um5D1.js";import{M as r}from"./MathRender-CkNMaa3x.js";import"./vendor-katex-7i1KP8HX.js";function a(){const a=e(),o=s.useRef(),l=s.useRef(),u=s.useRef(),c=s.useRef([]),d=s.useRef([]),p=s.useRef([]),[h,m]=s.useState({}),[x,v]=s.useState({0:0}),[j,q]=s.useState([0]),[f,g]=s.useState({}),[_,$]=s.useState(!1),[z,w]=s.useState(!1);function N(e,s){m((s=>({...s,[`questions.${e}.question_image`]:void 0})));let t;if(["image/png","image/jpeg","image/jpg"].includes(s.type)||(t="Allowed formats: PNG, JPG, JPEG"),s.size>4194304&&(t="Image must be less than 4MB"),/\..+\./.test(s.name)&&(t="Invalid file name format"),t)return m((s=>({...s,[`questions.${e}.question_image`]:t})));g((t=>({...t,[e]:s})));const n=URL.createObjectURL(s);p.current[e].src=n}function b(e){e.preventDefault(),$(!0)}function y(e){e.preventDefault(),$(!1)}return t.jsx("div",{className:"form",children:t.jsxs("div",{className:"container",children:[t.jsx("div",{className:"header",children:t.jsx("h1",{children:"Create Quiz"})}),t.jsxs("form",{children:[t.jsxs("div",{children:[t.jsx("label",{children:"Quiz title"}),t.jsx("input",{ref:o,type:"text",placeholder:"Quiz Title",required:!0,pattern:"/^[\\p{L}\\p{N}\\p{S}\\p{P}\\s]{3,50}$/u",minLength:3,maxLength:50,onChange:()=>m((e=>({...e,quiz_title:void 0})))}),h.quiz_title&&t.jsx("p",{className:"error",children:h.quiz_title})]}),t.jsxs("div",{children:[t.jsx("label",{children:"Quiz description"}),t.jsx("textarea",{ref:l,placeholder:"Quiz Description",required:!0,pattern:"/^[\\p{L}\\p{N}\\p{S}\\p{P}\\s]{3,150}$/u",minLength:3,maxLength:150,onChange:()=>m((e=>({...e,quiz_description:void 0})))}),h.quiz_description&&t.jsx("p",{className:"error",children:h.quiz_description})]}),t.jsxs("div",{children:[t.jsx("label",{children:"Quiz difficulty"}),t.jsxs("select",{ref:u,children:[t.jsx("option",{value:"1",children:"Easy"}),t.jsx("option",{value:"2",children:"Medium"}),t.jsx("option",{value:"3",children:"Hard"})]}),h.quiz_difficulty&&t.jsx("p",{className:"error",children:h.quiz_difficulty})]}),j.map((e=>{var s;return t.jsxs("div",{className:"question-card",children:[t.jsxs("div",{className:"question-header",children:[t.jsxs("h3",{children:["Question ",e+1]}),t.jsx("h3",{className:"delete",onClick:()=>{!function(e){j.length>1?(v((s=>delete s[e])),q((s=>[...s.slice(0,e),...s.slice(e+1)]))):m((e=>({...e,questions_limit:"You cant create a quiz without quesions"})))}(e)},children:"X"})]}),t.jsxs("div",{children:[t.jsx("label",{children:"Question Description"}),t.jsx("textarea",{placeholder:"Question Description (use $...$ for math equations)",required:!0,pattern:"^[\\p{L}\\p{N}\\p{S}\\p{P}\\s\\^\\_\\$\\\\\\/\\(\\)\\{\\}\\+=]{3,100}$",minLength:3,maxLength:100,ref:s=>c.current[e]=s,onChange:s=>{const t=n.sanitize(s.target.value).replace(/</g,"&lt;").replace(/>/g,"&gt;");s.target.value=t,m((s=>({...s,[`questions.${e}.question_description`]:void 0})))}}),h[`questions.${e}.question_description`]&&t.jsx("p",{className:"error",children:h[`questions.${e}.question_description`]}),t.jsx("div",{className:"math-preview",children:t.jsx(r,{content:(null==(s=c.current[e])?void 0:s.value)||""})})]}),t.jsxs("div",{children:[t.jsx("label",{children:"Question Image (Optional)"}),t.jsxs("label",{id:"file-upload",className:`upload-box ${f[e]?"success":""} ${h[`questions.${e}.question_image`]?"error":""} ${_?"active":""}`,onDragOver:b,onDragLeave:y,onDrop:s=>function(e,s){e.preventDefault(),$(!1);const t=e.dataTransfer.files[0];t&&N(s,t)}(s,e),children:[t.jsx("img",{src:"/upload-image.svg",alt:"",ref:s=>p.current[e]=s}),t.jsx("input",{type:"file",accept:"image/*",className:"image-upload",hidden:!0,onChange:s=>{N(e,s.target.files[0])}}),t.jsx("p",{children:"Drag & drop or Browse File to Upload"})]}),h[`questions.${e}.question_image`]&&t.jsx("p",{className:"error",children:h[`questions.${e}.question_image`]})]}),t.jsxs("div",{className:"answers-section",children:[t.jsx("h4",{children:"Answers"}),[0,1,2,3].map((s=>{var i,a,o,l;return t.jsxs("div",{className:"answer-input",children:[t.jsx("label",{children:"Answer text"}),t.jsx("input",{type:"text",placeholder:"Answer text (use ^ for exponents, _ for subscripts)",minLength:1,maxLength:50,required:!0,onChange:e=>{const s=n.sanitize(e.target.value).replace(/</g,"&lt;").replace(/>/g,"&gt;");e.target.value=s,q((e=>[...e]))},ref:t=>(d.current[e]=d.current[e]||[],d.current[e][s]=t)}),h[`questions.${e}.answers.${s}.question_answer_text`]&&t.jsx("p",{className:"error",children:h[`questions.${e}.answers.${s}.question_answer_text`]}),t.jsxs("label",{children:["Correct:",t.jsx("input",{type:"checkbox",checked:x[e]===s,onChange:()=>function(e,s){m((t=>({...t,[`questions.${e}.answers.${s}.correct_answer`]:void 0}))),v((t=>({...t,[e]:s})))}(e,s)}),h[`questions.${e}.answers.${s}.correct_answer`]&&t.jsx("p",{className:"error",children:h[`questions.${e}.answers.${s}.correct_answer`]})]}),t.jsx("div",{className:"math-preview",children:t.jsx(r,{content:(null==(a=null==(i=d.current[e])?void 0:i[s])?void 0:a.value)||""},null==(l=null==(o=d.current[e])?void 0:o[s])?void 0:l.value)})]},s)}))]})]},e)})),h.questions_limit&&t.jsx("p",{className:"error",children:h.questions_limit}),t.jsxs("button",{type:"button",onClick:function(){j.length<40?(m((e=>({...e,questions_limit:void 0}))),q((e=>{const s=e.length;return v((e=>({...e,[s]:0}))),[...e,s]}))):m((e=>({...e,questions_limit:"You can only add up to 40 questions per quiz"})))},children:["Add Question (",j.length,"/",50,")"]}),t.jsx("button",{disabled:z,type:"submit",onClick:e=>{!function(e){e.preventDefault(),w(!0);const s=new FormData;s.append("quiz_title",o.current.value),s.append("quiz_description",l.current.value),s.append("quiz_difficulty",u.current.value),j.forEach((e=>{var t;const n=(null==(t=c.current[e])?void 0:t.value)||"";s.append(`questions[${e}][question_description]`,n),f[e]&&s.append(`questions[${e}][question_image]`,f[e],`question_${e}_image`),[0,1,2,3].forEach((t=>{var n,i;const r=(null==(i=null==(n=d.current[e])?void 0:n[t])?void 0:i.value)||"",a=x[e]===t?"1":"0";s.append(`questions[${e}][answers][${t}][question_answer_text]`,r),s.append(`questions[${e}][answers][${t}][correct_answer]`,a)}))})),i.post("/quizzes",s,{headers:{"Content-Type":"multipart/form-data"}}).then((()=>{a("/dashboard/quizzes")})).catch((e=>{var s,t;if(null==(t=null==(s=e.response)?void 0:s.data)?void 0:t.errors){const s={};Object.entries(e.response.data.errors).forEach((([e,t])=>{s[e]=t[0]})),m(s)}})).finally((()=>{w(!1)}))}(e)},children:z?"Loading...":"Create Quiz"})]})]})})}export{a as default};
