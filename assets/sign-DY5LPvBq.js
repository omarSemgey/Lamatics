import{u as e,r as s,j as r,L as a}from"./vendor-react-B9slfjkH.js";import{u as n}from"./useGetUserRole-9DCMldbp.js";import{l as i}from"./vendor-CQ7Um5D1.js";import{L as l}from"./main-C1RESi2Z.js";import"./vendor-katex-7i1KP8HX.js";function t(){const n=e(),l=s.useRef(),t=s.useRef(),[d,o]=s.useState(!1),[c,u]=s.useState(!1),[h,m]=s.useState(!1),[p,x]=s.useState(!1);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"header",children:[r.jsx("h1",{children:"تسجيل دخول"}),r.jsxs("span",{children:[" سجل دخول او ",r.jsx(a,{to:"/signup",children:" انشئ حساب "})," "]})]}),r.jsxs("form",{children:[r.jsxs("div",{children:[r.jsx("label",{children:"عنوان البريد الالكتروني"}),r.jsx("input",{required:!0,ref:l,type:"email",placeholder:"عنوان البريد الالكتروني",pattern:"^[^\\s@]+@[^\\s@]+\\.[^\\s@]{2,6}$",maxLength:320}),c&&r.jsx("p",{className:"error",children:" يرجى إدخال عنوان بريد إلكتروني صالح (حد أقصى 320 حرفًا) "})]}),r.jsxs("div",{children:[r.jsx("label",{children:"كلمة المرور"}),r.jsx("input",{required:!0,ref:t,type:"password",placeholder:"كلمة المرور",pattern:"^(?=.*[A-Za-z])(?=.*\\d).{6,}$",minLength:6}),h&&r.jsx("p",{className:"error",children:" كلمة المرور يجب أن تحتوي على الأقل على 6 أحرف "}),d&&r.jsx("p",{className:"error",children:" كلمة المرور او عنوان البريد الالكتروني غير صحيح "})]}),r.jsx("button",{type:"submit",disabled:p,onClick:function(e){e.preventDefault(),x(!0),u(!1),m(!1),o(!1),i.post("/auth/login",{email:l.current.value,password:t.current.value}).then((e=>{localStorage.setItem("isAuthenticated",!0),e.data.role>1?n("/dashboard"):n("/quizzes")})).catch((e=>{var s,r,a;const n=null==(s=e.response)?void 0:s.status,i=(null==(a=null==(r=e.response)?void 0:r.data)?void 0:a.errors)||{};422===n&&(u(!!i.email),m(!!i.password)),401===n&&o(!0)})).finally((()=>{x(!1)}))},children:"تسجيل دخول"})]})]})}function d(){const n=e(),l=s.useRef(),t=s.useRef(),d=s.useRef(),[o,c]=s.useState({}),[u,h]=s.useState(!1);const m={name:{required:"حقل الاسم مطلوب",min:"الحد الأدنى للاسم ٣ أحرف",max:"الحد الأقصى للاسم ٢٥ حرفاً",regex:"يسمح فقط بالأحرف (من أي لغة)، الأرقام، المسافات، والشرطة السفلية (_). غير مسموح بالأحرف الخاصة أو الرموز الأخرى",unique:"الاسم مستخدم من قبل",invalid:"صيغة الاسم غير صحيحة"},email:{required:"حقل البريد الإلكتروني مطلوب",email:"صيغة البريد الإلكتروني غير صحيحة",max:"الحد الأقصى للبريد الإلكتروني ٣٢٠ حرفاً",regex:"يرجى إدخال بريد إلكتروني صحيح (مثال: example@domain.com)",unique:"البريد الإلكتروني مستخدم من قبل"},password:{required:"حقل كلمة المرور مطلوب",min:"الحد الأدنى لكلمة المرور ٦ أحرف",regex:"يجب أن تحتوي كلمة المرور على حرف إنجليزي ورقم واحد على الأقل",invalid:"صيغة كلمة المرور غير صحيحة"}};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"header",children:[r.jsx("h1",{children:"إنشاء حساب"}),r.jsxs("span",{children:[" انشئ حساب او ",r.jsx(a,{to:"/login",children:"سجل الدخول "})]})]}),r.jsxs("form",{children:[r.jsxs("div",{children:[r.jsx("label",{children:"اسم المستخدم"}),r.jsx("input",{required:!0,ref:l,type:"text",placeholder:"اسم المستخدم",pattern:"^[\\p{L}0-9_\\s]{3,25}$",minLength:3,maxLength:25}),o.name&&r.jsx("p",{className:"error",children:o.name})]}),r.jsxs("div",{children:[r.jsx("label",{children:"عنوان البريد الالكتروني"}),r.jsx("input",{required:!0,ref:t,type:"email",placeholder:"عنوان البريد الالكتروني",pattern:"^[^\\s@]+@[^\\s@]+\\.[^\\s@]{2,6}$",maxLength:320}),o.email&&r.jsx("p",{className:"error",children:o.email})]}),r.jsxs("div",{children:[r.jsx("label",{children:"كلمة المرور"}),r.jsx("input",{required:!0,ref:d,type:"password",placeholder:"كلمة المرور",pattern:"^(?=.*[A-Za-z])(?=.*\\d).{6,}$",minLength:6}),o.password&&r.jsx("p",{className:"error",children:o.password})]}),r.jsx("button",{type:"submit",disabled:u,onClick:function(e){e.preventDefault(),h(!0),c({}),i.post("/auth/register",{name:l.current.value.trim(),email:t.current.value,password:d.current.value,role:1}).then((e=>{localStorage.setItem("isAuthenticated",!0),e.data.role>1?n("/dashboard"):n("/quizzes")})).catch((e=>{var s,r;if(null==(r=null==(s=e.response)?void 0:s.data)?void 0:r.errors){const s={};Object.entries(e.response.data.errors).forEach((([e,r])=>{var a;const n=(i=r[0]).includes("already been taken")?"unique":i.includes("valid email address")?"email":i.includes("valid")?"regex":i.includes("required")?"required":i.includes("at least")?"min":i.includes("greater than")?"max":i.includes("must be")?"invalid":"other";var i;s[e]=(null==(a=m[e])?void 0:a[n])||r[0]})),c(s)}})).finally((()=>{h(!1)}))},children:"إنشاء حساب"})]})]})}function o({mode:s}){const{role:a,isLoading:i}=n(),o=e();return i?r.jsx(l,{}):(a>1?o("/dashboard"):1==a&&o("/quizzes"),r.jsx(r.Fragment,{children:r.jsx("div",{className:"sign",children:r.jsx("div",{className:"container",children:"login"==s?r.jsx(t,{}):r.jsx(d,{})})})}))}export{o as default};
