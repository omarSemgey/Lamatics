import{f as s,u as e,r as i,j as n}from"./vendor-react-B9slfjkH.js";import{L as a}from"./main-C1RESi2Z.js";import{l as t}from"./vendor-CQ7Um5D1.js";import{C as r}from"./ConfirmationModal-DeusARzF.js";import{M as o}from"./MathRender-CkNMaa3x.js";import"./vendor-katex-7i1KP8HX.js";function u(){const{quiz:u}=s(),c=e(),[l,d]=i.useState(!0),[m,q]=i.useState({}),[j,h]=i.useState({}),[x,z]=i.useState([]),[_,p]=i.useState({}),[f,v]=i.useState(!1);return i.useEffect((()=>{(async()=>{await t.get(`/quizzes/${u}`).then((s=>{s.data.completed?c(`/quizzes/results/${u}`):(h(s.data.quiz),z(s.data.quiz.quiz_questions||[]))})).finally((()=>{d(!1)}))})()}),[u]),l?n.jsx(a,{}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"quiz-session",children:[n.jsxs("div",{className:"quiz-header",children:[n.jsx("h1",{className:"quiz-title",children:j.quiz_title}),n.jsx("p",{className:"quiz-description",children:j.quiz_description})]}),n.jsxs("div",{className:"quiz-questions",children:[x.map(((s,e)=>{var i;return n.jsxs("div",{className:"question-card",children:[n.jsxs("div",{className:"question-header",children:[n.jsxs("span",{className:"question-number",children:["السؤال ",e+1]}),n.jsx("h3",{className:"question-text",children:n.jsx(o,{content:s.question_description||""})})]}),s.question_image&&n.jsx("div",{className:"question-image",children:n.jsx("img",{src:s.question_image,alt:`السؤال البصري ${e+1}`})}),n.jsx("div",{className:"answers-list",children:null==(i=s.question_answers)?void 0:i.map(((e,i)=>n.jsxs("div",{className:"answer "+(_[s.quiz_question_id]===e.question_answer_id?"selected":""),onClick:()=>{return i=s.quiz_question_id,n=e.question_answer_id,void p((s=>({...s,[i]:n})));var i,n},children:[n.jsx("span",{className:"answer-letter",children:String.fromCharCode(65+i)}),n.jsx("div",{className:"answer-text",children:n.jsx(o,{content:e.question_answer_text||""})})]},e.question_answer_id)))})]},s.quiz_question_id)})),n.jsxs("div",{className:"submit-container",children:[n.jsx("button",{className:"submit-quiz-button",onClick:function(){Object.keys(_).length==x.length&&v(!0)},children:"تسليم الإجابات"}),m.answers&&n.jsx("p",{className:"error",children:"الرجاء الإجابة على جميع الأسئلة قبل التسليم!"})]})]})]}),n.jsx(r,{isOpen:f,onClose:function(){v(!1)},onConfirm:async function(){t.post("/submissions",{quiz_id:u,answers:_}).then((()=>{c(`/quizzes/results/${u}`)})).catch((s=>{var e,i;if(null==(i=null==(e=s.response)?void 0:e.data)?void 0:i.errors){const e={};Object.entries(s.response.data.errors).forEach((([s,i])=>{e[s]=i[0]})),q(e)}})).finally((()=>{v(!1)}))},message:"هل أنت متأكد أنك تريد تسليم الامتحان؟"})]})}export{u as default};
